{
    "name": "Buffer Overflow",
    "variant": "CS1 C++",
    "sections": [
        {
            "header": "Background",
            "units": [
                {
                    "type": "subheader",
                    "text": "Summary:"
                },
                {
                    "type": "paragraph",
                    "text": "Buffer overflow occurs when data is input or written beyond the allocated bounds of an object, such as an array, causing a program crash or creating a vulnerability that attackers might exploit."
                },
                {
                    "type": "subheader",
                    "text": "Description:"
                },
                {
                    "type": "paragraph",
                    "text": "A buffer overflow occurs when data is written beyond the boundaries of a fixed length buffer overwriting adjacent memory locations which may include other buffers, variables, and program flow instructions. Considered the “nuclear bomb” of the software industry, the buffer overflow is one of the most persistently exploited security vulnerabilities and frequently used attacks."
                },
                {
                    "type": "paragraph",
                    "text": "<a href = https://www.youtube.com/watch?v=5Seq4pv4nvA> https://www.youtube.com/watch?v=5Seq4pv4nvA</a>"
                },
                {
                    "type": "paragraph",
                    "text": "<small><small>Video by Lydia Spurrier and Miya Dubler.</small></small>"
                },
                {
                    "type": "subheader",
                    "text": "Risk: How Can It Happen?"
                },
                {
                    "type": "paragraph",
                    "text": "Writing outside the bounds of a block of allocated memory can corrupt data, crash the program, or allow the execution of malicious code. However, Java is designed to avoid buffer overflow by checking the bounds of a buffer (like an array) and preventing any access beyond those bounds. Even though Java may prevent a buffer overflow from becoming a security issue, it is essential for all programmers to understand the concepts described below."
                },
                {
                    "type": "subheader",
                    "text": "Real-world Example:"
                },
                {
                    "type": "paragraph",
                    "text": "A buffer overflow in a 2004 version of AOL's AIM instant-messaging software exposed users to buffer overflow vulnerabilities. If a user posted a URL in their “I'm away” message, any of his or her friends who clicked on that link might be vulnerable to attack. AOL's response was to suggest that users update to a new version that would fix the bug.<br><small><small><small>Paul Roberts “AOL IM 'Away' message flaw deemed critical”, Infoworld, August 9, 2004<a href = http://www.infoworld.com/article/04/08/09/HNaolimflaw_1.html > http://www.infoworld.com/article/04/08/09/HNaolimflaw_1.html</a></small></small></small>"
                },
                {
                    "type": "subheader",
                    "text": "Example in Code:"
                },
                {
                    "type": "codeblock",
                    "code": "./exampleInCode.cpp"
                },
                {
                    "type": "paragraph",
                    "text": "When this program is run, the loop counter will exceed the value of a suitable index for the array. When the assignment statement tries to store a value in vals[10], buffer overflow occurs. The result is unpredictable. Depending on the operating system and the specific nature of the overflow, it may not cause any apparent problems, or it will cause the program to crash. Buffer Overflow can occur in many languages. In Java, the code results in an ArrayIndexOutOfBoundsException."
                },
                {
                    "type": "subheader",
                    "text": "Answer the following questions:"
                },
                {
                    "type": "question",
                    "id": "bf",
                    "prompt": "A buffer overflow can write over adjacent data such as:",
                    "ignored": false,
                    "mode": "checkbox",
                    "choices": [
                        {
                            "id": "variables",
                            "text": "Variables",
                            "ans": true
                        },
                        {
                            "id": "program",
                            "text": "Program flow instructions",
                            "ans": true
                        },
                        {
                            "id": "other",
                            "text": "Other buffers",
                            "ans": true
                        }
                    ]
                },
                {
                    "type": "question",
                    "id": "unchecked",
                    "prompt": "An unchecked buffer overflow may cause:",
                    "ignored": false,
                    "mode": "checkbox",
                    "choices": [
                        {
                            "id": "data",
                            "text": "Data to be corrupted",
                            "ans": true
                        },
                        {
                            "id": "crash",
                            "text": "A program crash",
                            "ans": true
                        },
                        {
                            "id": "correct",
                            "text": "The program to correct itself",
                            "ans": false
                        },
                        {
                            "id": "execution",
                            "text": "The execution of malicious code",
                            "ans": true
                        },
                        {
                            "id": "unexpected",
                            "text": "Unexpected behavior",
                            "ans": true
                        }
                    ]
                }
            ]
        },
        {////////////////////////////////////////////////////////
            "header": "Code Responsibly",
            "units": [
                {
                    "type": "subheader",
                    "text": "How Can I Avoid Buffer Overflow?"
                },
                {
                    "type": "list",
                    "items": [
                        "<i><strong>Make sure you have enough space:</strong></i> Before copying data to a fixed size block, make sure it is large enough to hold the data that you are going to copy. If it is not large enough, do not copy more data than your available space can hold. If your program is not able to continue properly after filling the available space, you may have to find some way to recover from the error.",
                        "<i><strong>Validate indices:</strong></i>  If you have an integer variable, verify that it is within the proper bounds before you use it as an index to an array. This validation is particularly important for any values that might have been provided as user input or other untrusted input, such as information that might be read from a file or from a network connection."
                    ],
                    "ordered": false
                },
                {
                    "type": "subheader",
                    "text": "Answer the following questions:"
                },
                {
                    "type": "question",
                    "id": "variable",
                    "prompt": "A variable used for an array index could be obtained from:",
                    "ignored": false,
                    "mode": "checkbox",
                    "choices": [
                        {
                            "id": "file",
                            "text": "A file",
                            "ans": true
                        },
                        {
                            "id": "network",
                            "text": "A network",
                            "ans": true
                        },
                        {
                            "id": "user input",
                            "text": "User input",
                            "ans": true
                        }
                    ]
                },
                {
                    "type": "question",
                    "id": "legal",
                    "prompt": "Given the following array:<br><br><code>int scores [100];</code><br><br> Specify the legal range or bounds for an array index i:",
                    "ignored": false,
                    "mode": "radio",
                    "choices": [
                        {
                            "id": "1",
                            "text": "0 < i < 100"
                        },
                        {
                            "id": "2",
                            "text": "0 < i <= 100"
                        },
                        {
                            "id": "3",
                            "text": "0 <= i < 100"
                        },
                        {
                            "id": "4",
                            "text": "0 <= i <= 100"
                        }
                    ],
                    "answer": "3"
                }
            ]
        },
        {
            "header": "Laboratory Assignment",
            "units": [
                {
                    "type": "paragraph",
                    "text": "<strong>STEP 1:</strong> Type (do not copy and paste) the example in code into a program and compile. Run the program."
                },
                {
                    "type": "subheader",
                    "text": "Example in Code:"
                },
                {
                    "type": "codeblock",
                    "code": "./labAssignment.java"
                },
                {
                    "type": "question",
                    "id": "q1",
                    "prompt": "What happens when you compile and run the example in code? Why?",
                    "ignored": false,
                    "mode": "radio",
                    "choices": [
                        {
                            "id": "buffer overflow",
                            "text": "The code outputs \"after buffer overflow: \" and \"importantdata = 1\"."
                        },
                        {
                            "id": "error",
                            "text": "An error occurs because the buffer array is not properly declared."
                        },
                        {
                            "id": "loopError",
                            "text": "The error ArrayIndexOutOfBoundsException occurs because the array has a max index of 10 elements and is set to accept 15 from the for loop."
                        }
                    ],
                    "answer": "loopError"
                },
                {
                    "type": "paragraph",
                    "text": "<strong>STEP 2:</strong> Fix the error and run again."
                },
                {
                    "type": "paragraph",
                    "text": "<strong>STEP 3:</strong> Type (do not copy and paste) Program 1 into a new program and compile. Run the program."
                },
                {
                    "type": "subheader",
                    "text": "Program 1:"
                },
                {
                    "type": "codeblock",
                    "code": "./labAssignment2.java"
                },
                {
                    "type": "question",
                    "id": "q2",
                    "prompt": "Potential buffer overflow could occur in the array \"tests\" due to assignments, inputs, or operations that may modify the index variables. How could we prevent this?",
                    "ignored": false,
                    "mode": "radio",
                    "choices": [
                        {
                            "id": "less",
                            "text": "The vulnerability occurs because we do not set a limit on the amount of integers the user must input to ensure count is greater than or equal to 10. We can prevent this by making sure that count is never less than 10."
                        },
                        {
                            "id": "greater",
                            "text": "The vulnerability occurs because we do not set a max on the amount of integers the user can input to ensure count is less than 10. We can prevent this by making sure that count is never greater than or equal to 10."
                        },
                        {
                            "id": "double",
                            "text": "The vulnerability occurs because we declare test improperly. We can prevent this by making sure that test is declared a double."
                        },
                        {
                            "id": "prevent",
                            "text": "We cannot prevent it."
                        }
                    ],
                    "answer": "greater"
                },
                {
                    "type": "paragraph",
                    "text": "<strong>STEP 4:</strong> Revise the program to eliminate potential buffer overflow problems."
                }
            ]
        },
        {
            "header": " Security Checklist",
            "units": []
        },
        {
            "header": "Discussion Questions",
            "units": [
                {
                    "type": "question",
                    "id": "Dquestion1",
                    "prompt": "Describe the buffer overflow problem.",
                    "ignored": true,
                    "mode": "textarea",
                    "pattern": "null"
                },
                {
                    "type": "question",
                    "id": "Dquestion2",
                    "prompt": "How could you prevent a buffer overflow from occurring in your program?",
                    "ignored": true,
                    "mode": "textarea",
                    "pattern": "null"
                },
                {
                    "type": "question",
                    "id": "Dquestion3",
                    "prompt": "Give three real life examples of buffer overflow attacks (research on the web).",
                    "ignored": true,
                    "mode": "textarea",
                    "pattern": "null"
                },
                {
                    "type": "question",
                    "id": "Dquestion4",
                    "prompt": "What can result from a buffer overflow ?",
                    "ignored": true,
                    "mode": "textarea",
                    "pattern": "null"
                },
                {
                    "type": "question",
                    "id": "Dquestion5",
                    "prompt": "Provide three different examples of code that contains buffer overflows.",
                    "ignored": true,
                    "mode": "textarea",
                    "pattern": "null"
                }
            ]
        }
    ]
}